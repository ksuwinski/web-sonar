<html>
    <head>
        <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
        <style>
        html {
            font-family: Arial, Helvetica, sans-serif;
        }
        .page-title {
            text-align: center;
        }
        .info-section h1 {
            font-size: large;
        }
        #rangedoppler-canvas {
            background-color: black;
            float: right;
            grid-column: 3;
        }
        .rd-plot-container {
            display: grid;
            grid-template-columns: 20px 40px auto;
            grid-template-rows: auto 20px;
        }
        .settings-and-info {
            display: flex;
            margin-top: 10px;
        }
        .settings {
            width: 50%;
        }
        .setting-value, .info-value {
            font-weight: bold;
        }
        .velocity-axis-label, .range-axis-label {
            font-size: large;
        }
        .info-multiple-values{
            margin-left: 2em;
        }
        .velocity-axis-label {
            writing-mode: vertical-lr;
            margin-right: 2px;
            text-align: center;
            transform: rotate(180deg);
        }
        #range-axis-ticks{
            grid-column: 3;
            position: relative;
        }
        #velocity-axis-ticks{
            position: relative;
        }
        #range-axis-ticks div, #velocity-axis-ticks div {
            position: absolute;
        }
        .range-axis-label{
            text-align: center;
            grid-column: 3;
            margin-top: 2px;
        }
        .controls {
            display: flex;
            flex-direction: row;
            margin-bottom: 10px;
        }
        #button-start {
            margin-right: 20px;
        }
        .range-setting label {
            display: block;
        }
        .checkbox-setting {
            display: flex;
            align-items: center;
        }
        .controls, .range-setting, .checkbox-setting{
            margin-bottom: 10px;
        }
        input[type=range] {
            width:200px;
        }
        .info-container {
            margin-left: auto;
        }
        .info-item {
            margin-bottom: 5px;
        }
        .hoverable {
            border-bottom: dotted 1px gray;
        }
        </style>
    </head>
    </div>
    <body>
        <!-- <div
            id="plot-container"
            style="position: relative; height: 40vh; width: 80vw"
        >
            <canvas id="myChart"></canvas>
        </div> -->
        <h1 class="page-title">Online sonar demonstrator (epic)</h1>
        <div class="rd-plot-container">
            <div class="velocity-axis-label">bistatic velocity</div>
            <div id="velocity-axis-ticks"></div>
            <canvas
                id="rangedoppler-canvas"
                width="128"
                height="20"
                style="width: 100%; height:50vh; image-rendering: pixelated;"
                <!-- style="width: 640px; height: 200px" -->
            ></canvas>
            <div id="range-axis-ticks"></div>
            <div class="range-axis-label">bistatic range</div>
        </div>

        <div class="settings-and-info">
            <form class="settings" id="settings-form">
                <div class="controls">
                    <button id="button-start">start</button>
                    <div>peak input level: <meter id="input-level-meter" min="0" max="100" low="40" high="90"></meter> <span id="input-level-label">0</span>%</div>
                </div>

                <div class="range-setting">
                    <label for="center-freq-range">center frequency: <span class="setting-value" id="center-freq-range-label"></span> Hz</label>
                    <input id="center-freq-range" type="range" min="1000" max="22000" step="500" value="18000">
                </div>

                <div class="range-setting">
                    <label for="bandwidth-range">
                        <span class="hoverable" title="difference between initial and final frequency of the chirp">nominal bandwidth</span>:
                        <span class="setting-value" id="bandwidth-range-label"></span>
                        Hz
                    </label>
                    <input id="bandwidth-range" type="range" min="0" max="5" step="1" list="markers" value="2">
                    <datalist id="markers">
                        <option value="0"></option>
                        <option value="1"></option>
                        <option value="2"></option>
                        <option value="3"></option>
                        <option value="4"></option>
                        <option value="5"></option>
                    </datalist>
                </div>

                <div class="checkbox-setting">
                    <label for="offset-checkbox">compensate audio delay:</label>
                    <input id="offset-checkbox" type="checkbox" checked>
                </div>

                <fieldset class="clutter-filter-settings">
                  <legend
                      class="hoverable"
                      title="Clutter filter removes stationary echoes from walls and from the direct path between speaker and microphone.">
                      Clutter filtering
                  </legend>

                  <div>
                    <input id="clutterfilter-option-none" type="radio" name="clutterfilter" value="none" />
                    <label for="clutterfilter-option-none">None</label>
                  </div>
                  <div>
                    <input id="clutterfilter-option-twopulse" type="radio" name="clutterfilter" value="two-pulse" />
                    <label for="clutterfilter-option-twopulse">Two-pulse canceller</label>
                  </div>
                  <div>
                    <input id="clutterfilter-option-slow" type="radio" name="clutterfilter" value="slow" checked />
                    <label for="clutterfilter-option-slow" class="hoverable" title="create a coherent clutter map using exponential moving average filter, and subtract the map from each impulse">Subtract clutter map</label>
                  </div>
                  <div>
                    <input id="clutterfilter-option-removezero" type="radio" name="clutterfilter" value="remove-zero" />
                    <label for="clutterfilter-option-removezero">Remove the v=0 slice</label>
                  </div>
                </fieldset>
            </form>
            <div class="info-container">
                <div class="info-section">
                    <h1>Basic radar parameters</h1>
                    <div class="info-item">
                        <span class="hoverable" title="width of a single cell in the range-doppler map">range resolution</span>:
                        <span class="info-value" id="range-resolution-label"></span>
                        cm
                    </div>
                    <div class="info-item">
                        <span class="hoverable" title="height of a single cell in the range-doppler map">velocity resolution</span>:
                        <span class="info-value" id="velocity-resolution-label"></span>
                        cm/s
                    </div>
                    <div class="info-item">
                        <span class="hoverable" title="maximum value of bistatic range, bigger ranges loop back to zero">range ambiguity:/span>:
                        <span class="info-value" id="range-ambiguity-label"></span>
                        m
                    </div>
                    <div class="info-item">
                        <span class="hoverable"
                              title="maximum value of velocity, greater values cause aliasing (looping to the opposite edge of range-doppler map)"
                        > velocity ambiguity
                        </span>:
                        <span class="info-value" id="velocity-ambiguity-label"></span>
                        m/s
                    </div>
                    <div class="info-item">
                        <span class="hoverable" title="the frequency at which consecutive chirps are played">pulse repetition frequency</span>:
                        <span class="info-value" id="prf-label"></span>
                        Hz
                    </div>
                    <div class="info-item">
                        <span class="hoverable" title="total duration of input processed to obtain a range-doppler map&#10;(chirp duration Ã— chirps per CPI)">coherent processing interval</span>:
                        <span class="info-value" id="CPI-label"></span>
                        ms
                    </div>
                    <div class="info-item">
                        wavelength:
                        <span class="info-value" id="wavelength-label"></span>
                        cm
                    </div>
                </div>
                <div class="info-section">
                    <h1>Advanced info</h1>
                    <div class="info-item">
                        range migration over one CPI:
                        <div class="info-multiple-values">
                            <div class="multiple-values-option">
                                1 R cell per
                                <span class="info-value" id="max-migrationless-velocity-label"></span>
                                cm/s
                            </div>
                            <div class="multiple-values-option">
                                1 R cell per
                                <span class="info-value" id="max-migrationless-velocity-cell-units-label"></span>
                                V cells
                            </div>
                        </div>
                    </div>
                    <div class="info-item">range-velocity coupling:
                        <div class="info-multiple-values">
                            <div class="multiple-values-option">
                                <span class="info-value" id="range-velocity-coupling-label"></span>
                                cm per m/s
                            </div>
                            <div class="multiple-values-option">
                                <span class="info-value" id="cell-unit-rv-coupling-label"></span>
                                R cell per V cell
                            </div>
                        </div>
                    </div>
                    <div class="info-item">
                        decimation:
                        <span class="info-value" id="decimation-label"></span>
                    </div>
                </div>
            </div>
        </div>
        <img src="sonar.svg"></object>
        <script src="chart.js"></script>
        <script src="javascript/sonar.js" type="module"></script>
    </body>
</html>
